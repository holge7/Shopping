package holge.shopping.userservice.kafka;

import java.util.HashMap;

import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.annotation.KafkaListener;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

@Configuration
public class UserConsumer {
	
    @KafkaListener(id = "myId", topics = "login")
    public void listen(String userSerialize) throws JsonProcessingException {
    	HashMap<String, String> itemWithOwner = new ObjectMapper().readValue(userSerialize, HashMap.class);
    	System.out.println(itemWithOwner.get("email"));
    }
    
    
    
    
    
}
